<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedback Form with CAPTCHA</title>
    <link rel="stylesheet" href="../styles/styles.feedback.css">
    <link rel="stylesheet" href="../styles/styles.css">
    <script>
        // Function to generate a random alphanumeric CAPTCHA code
        function generateRandomCaptcha(length) {
        const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        let captcha = '';
        for (let i = 0; i < length; i++) {
            const randomIndex = Math.floor(Math.random() * charset.length);
            captcha += charset.charAt(randomIndex);
        }
        return captcha;
        }

        // Function to refresh the CAPTCHA
        function refreshCaptcha() {
            const captchaInput = document.getElementById('captcha');
            const captchaImg = document.getElementById('captcha-img');
            const captchaCode = generateRandomCaptcha(6);

            captchaInput.value = '';
            captchaImg.src = `https://via.placeholder.com/150x30/007BFF/FFFFFF?text=${captchaCode}`;
        }  

        // Function to handle form submission
        function submitForm(event) {
            event.preventDefault();
            const captchaInput = document.getElementById('captcha');
            const captchaCode = captchaInput.value;
            const expectedCode = document.getElementById('captcha-img').src.split('=')[1];

            if (captchaCode.toUpperCase() === expectedCode.toUpperCase()) {
                alert(`Form submitted successfully!\n\nName: ${document.getElementById('feedback-name').value}\nEmail: ${document.getElementById('feedback-email').value}\nMessage: ${document.getElementById('feedback-message').value}`);
                refreshCaptcha();
            } else {
                alert('CAPTCHA code is incorrect. Please try again.');
                refreshCaptcha();
            }
        }

        refreshCaptcha();
    </script>
</head>
<div class="discount-banner" id="summer-disc"> 
    <p>Summer special: Book a no-deposit cleaning in advance to get 20% off</p>
</div>
<header id="header">
    <div>
        <a href="../index.html"><img class="logo" id="header-logo" src="../assets/logos/logo.png" alt="logo"></a>
    </div>  
    <nav>
        <ul id="header-links">
            <li>
                <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
                <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
                <a href="" class="hl" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/speedysqueegyllc/window-cleaning?hide_gdpr_banner=1'});return false;">Schedule Now</a>
            </li>
            <li>
                <a class="hl" href="#footer-number">Contact</a>
            </li> 
            <li>
                <a class="hl" href="../html/gallery.html">Gallery</a>
            </li> 
            <li>
                <a class="hl" href="../html/testimonials.html">Testimonials</a>
            </li> 
            <li> 
                <a class="hl" href="../html/feedback.html">Feedback</a>
            </li>
        </ul>
    </nav>
</header>    
<body>
    <div class="main-feedback">
        <div class="feedback-container">
            <h1>Feedback</h1>
            <form id="feedbackForm" onsubmit="submitForm(event)">
                <label for="feedback-name">Name:</label>
                <input type="text" id="feedback-name" name="feedback-name" required>
        
                <label for="feedback-email">Email:</label>
                <input type="email" id="feedback-email" name="feedback-email" required>
        
                <label for="feedback-message">Message:</label>
                <textarea id="feedback-message" name="feedback-message" rows="4" placeholder="Wow, my windows are so clean, I'm worried birds might fly into them thinking they're open skies!" required></textarea>
        
                <div class="captcha-container">
                    <input type="text" id="captcha" name="captcha" placeholder="Enter the code" required>
                    <img id="captcha-img" src="" alt="CAPTCHA" onclick="refreshCaptcha()">
                </div>
        
                <button type="submit" id="feedback-button">Send</button>
            </form>
        </div>
    </div>
</body>
<footer>
    <div id="footer-container">
        <img src="../assets/logos/logo.png" alt="logo" id="footer-logo" loading="lazy">
        <div id="footer-links-container">
            <div class="footer-links">
                <a href="mailto:info@speedysqueegy.com" class="hl">info@speedysqueegy.com</a>
                <a href="../html/tos.html" class="hl">Terms of Service</a>
                <a class="hl">The Speedy Way</a>
                <a href ="../html/feedback.html" class="hl">Feedback</a>
            </div>
        </div>
        <div id="copy-container">
            <span>Designed and Developed by Jake Green</span>
        </div>
        <img src="../assets/logos/phone.png" alt="phone number" id="footer-number" loading="lazy">
    </div>
</footer>
</html>
